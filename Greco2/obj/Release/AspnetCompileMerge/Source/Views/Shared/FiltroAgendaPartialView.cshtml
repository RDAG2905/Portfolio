@using Greco2.Models.Evento
@model AgendaModelView

<style>

    @@keyframes lds-dual-ring {
        0% {
            transform: rotate(0deg);
        }

        100% {
            transform: rotate(360deg);
        }
    }

    .loader-container {
        width: 40px;
        height: 40px;
        margin-left: 48%;
        margin-top: -30%;
        /*margin-left:68%;*/
    }

        .loader-container .loader {
            width: 100%;
            height: 100%;
            /*margin-left:50%;*/
            /*z-index:10000;*/
            /*padding-bottom:500px;*/
            /*position:absolute;*/
            border: solid 8px transparent;
            border-top-color: #337ab7;
            border-bottom-color: #337ab7;
            border-left-color: #f2f2f2;
            /*border--color: #337ab7;*/
            border-radius: 50%;
            animation: lds-dual-ring 1.2s linear infinite;
        }
   
    .form-control {
        /*background-image: linear-gradient(white 60%,#f2f2f2);*/
        font-size: 11px;       
    }

    h4 {
        font-family: 'Berlin Sans FB';
    }


    /*body {
      
        background-image: linear-gradient(#e6e6e6,white);
       
    }*/

    a:active {
        background-color: blue;
        color: white;
    }

    .jumbotron {
        justify-content: center;
        padding-top: 10px;
        padding-bottom: 5px;
        margin-left: -8px;
        /*background-color:#e6e6e6;*/
    }



   


    label {
        font-size: 12px;
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        /*color: #4d4d4d;*/
        color: #111a00;
        width:200px;
    }
   
    .list-group-item {
        border-radius: 8px;
    }

    .row {
        text-align: left;
    }

    .item1 {
        grid-area: left;
        /*padding-left: -50px;*/
        background-color: #f2f2f2;
        border-radius: 8px;
        padding-top: 5px;
    }

    .item3 > div > div > label {
    margin-left:-20px;
    }
   
    .item3 > input {
    width:280px;
    }
   
    .item2 {
        grid-area: left-d;
    }

    .item4 > div > div > input[type="button"] {
     width:150px; 
    
    }

    /*input[type="button"] {
        margin-right: 20px;
        width: 140px;
    }*/

    input[type="button"]:hover {
        -webkit-box-shadow: 0px 1px 10px 0px rgba(0,0,0,0.25);
        -moz-box-shadow: 0px 1px 10px 0px rgba(0,0,0,0.25);
        box-shadow: 0px 1px 10px 0px rgba(0,0,0,0.25);
        /*-webkit-box-shadow: 0px 3px 8px 0px rgba(12,79,130,1);
        -moz-box-shadow: 0px 3px 8px 0px rgba(12,79,130,1);
        box-shadow: 0px 3px 8px 0px rgba(12,79,130,1);*/
        /*-webkit-box-shadow: 0px 1px 10px 0px rgba(12,79,130,1);
        -moz-box-shadow: 0px 1px 10px 0px rgba(12,79,130,1);
        box-shadow: 0px 1px 10px 0px rgba(12,79,130,1);*/
    }

    .item3 {
        grid-area: right;
        /*background-color: #f2f2f2;*/
        background-color: #f5f5f5;
        /*padding-left: 60px;*/
        border-radius: 8px;
        padding-top: 10px;
    }

    /*.item3:hover {
        -webkit-box-shadow: 0px 1px 10px 0px rgba(0,0,0,0.25);
        -moz-box-shadow: 0px 1px 10px 0px rgba(0,0,0,0.25);
        box-shadow: 0px 1px 10px 0px rgba(0,0,0,0.25);
    }*/

    .grid-container {
        /*grid-template-areas: 'left left center center right right';*/
        /*grid-template-areas: 'left left left' 'right right right' 
                               'left-d left-d left-d' 'right right right';*/
         grid-template-areas: 'left' 'right' 
                               'left-d';

        grid-gap: 20px;
        display: grid;
        margin-left: -10px;
        
    }

    .grid-item {
        border: 1px solid rgba(0, 0, 0, 0.8);
       
    }

    /*@@media(min-width: 1150px) {*/
        @@media(min-width: 1000px) {
            .grid-container {
                /*grid-template-areas: 'left left center center right right';*/
                grid-template-areas: 'left left left right right right' 'left-d left-d left-d right right right';
                grid-gap: 20px;
                display: grid;
                margin-left: -10px;
            }
        }
       
</style>
<div class="list-group-item" style="padding-left:30px;padding-right:25px;margin-left:-60px;margin-right:-55px;border-color:#f2f2f2;
        -webkit-box-shadow: 10px 10px 5px -2px rgba(209,202,209,1);
        -moz-box-shadow: 10px 10px 5px -2px rgba(209,202,209,1);
        box-shadow: 10px 10px 5px -2px rgba(209,202,209,1);">
    <div class="jumbotron" style="max-height:45px;padding-top:5px;background-color:white;">
        <div class="row">
            <div class="col-xs-1">
                <i style="padding-top:9px;" class="glyphicon glyphicon-th"></i>
            </div>
            <div class="col-xs-1">
                <h4 class="text-primary">AGENDA</h4>
            </div>
            
        </div>
    </div>
    <form>
        @Html.AntiForgeryToken()


        <div class="grid-container list-group-item" style="border-style:none;margin-top:-30px;">
            <div class="item1" style="font-size:13px;">
                <br />

                <div class="row">
                    <div class="col-md-6 col-xs-6">
                        <label>Desde </label>
                    </div>
                    <div class="col-md-6 col-xs-6">
                        <input class="form-control" type="date" id="fechaDesde" value="@Model.fechaDesde" @*onchange="clonarFecha(this)"*@ onkeypress="onEnterAgenda(event)" style="margin-left:-60px;" />
                        <input type="hidden" id="fechaDesdeOculta" value="@Model.fechaDesde" />
                    </div>


                </div>
                <div class="row">
                    <div class="col-md-6 col-xs-6">
                        <label>Hasta </label>
                    </div>
                    <div class="col-md-6 col-xs-6">
                        <input class="form-control" type="date" id="fechaHasta" value="" @*value="@Model.fechaHasta"*@ style="margin-left:-60px;" onkeypress="onEnterAgenda(event)" />
                    </div>


                </div>

                <br />

                <div>

                </div>


            </div>
            <br />
            <br />
            <div class="item4 " style="font-size:13px;">
                <div class="row">

                    <div class="col-xs-6 col-md-6">
                        <label>Fecha de Vencimiento</label>
                    </div>

                    <div class="col-xs-6 col-md-6">
                        <input type="radio" name="radioFecha" id="filtroPorFechaVencimiento" value="@Model.filtrarPorFechaVencimiento" checked>
                    </div>

                </div>

                <div class="row">

                    <div class="col-xs-6 col-md-6">
                        <label>Fecha de Notificación</label>
                    </div>

                    <div class="col-xs-6 col-md-6">
                        <input type="radio" name="radioFecha" id="filtroPorFechaNotificacion" value="@Model.filtrarPorFechaNotificacion">
                    </div>
                </div>
                <div class="row" style="height:25px">

                    <div class="col-xs-6 col-md-6">
                        <label>Fecha de Notificación Gcia.</label>
                    </div>

                    <div class="col-xs-6 col-md-6">
                        <input type="radio" name="radioFecha" id="filtroPorFechaNotificacionGcia" value="@Model.filtrarPorFechaNotificacionGcia">
                    </div>
                </div>

                <br />
                <div class="row" style="margin-left:-25px;">
                    <div class="col-xs-4 col-md-4">
                        <input type="button" class="btn btn-sm btn-primary" value="Buscar Eventos "
                               style="margin-bottom:10px;" onclick="BuscarListAgenda()" />
                    </div>
                    <div class="col-xs-4 col-md-4">
                        <input type="button" class="btn btn-sm btn-primary" value="Limpiar Filtros"
                               style="margin-bottom:10px" onclick="limpiarFiltrosAgendaMM()" />
                    </div>
                    <div class="col-xs-4 col-md-4">
                        <input type="button" class="btn btn-primary btn-sm" value="Cancelar Selección" onclick="cancelarSeleccion()" />
                    </div>
                </div>

                <div class="row" style="margin-left:-25px;">
                    <div class="col-xs-4 col-md-4">
                        <input type="button" class="btn btn-primary btn-sm" value="Seleccionar Todo" onclick="checkAllItemsAgenda()" />
                    </div>
                    <div class="col-xs-4 col-md-4">
                        <input type="button" class="btn btn-primary btn-sm" value="Invertir Selección" onclick="unCheckAllItemsAgenda()" />
                    </div>
                    <div class="col-xs-4     col-md-4">
                        <input type="button" class="btn btn-primary btn-sm" value="Aceptar Selección" onclick="aceptarSeleccionDeEventos()" />
                    </div>
                </div>



            </div>


            <div class="item3" style="font-size:12px;">


                <div class="row" style="margin-top:5px;">
                    <div class="col-xs-6 col-md-5">
                        <label>Tipo Evento</label>
                    </div>
                    <div class="col-xs-6 col-md-6">
                        @Html.DropDownList("tipoEventos", Model.tipoEventos, "", new { @class = "form-control", style = "height:25px;" })
                    </div>
                </div>
                <div class="row">
                    <div class="col-xs-6 col-md-5">
                        <label>Estudio Externo</label>
                    </div>
                    <div class="col-xs-6 col-md-6">
                        @Html.DropDownList("estudios", Model.Estudios, "", new { @class = "form-control", style = "height:25px;" })
                    </div>
                </div>
                <div class="row">
                    <div class="col-xs-6 col-md-5">
                        <label>Provincia</label>
                    </div>
                    <div class="col-xs-6 col-md-6">
                        @Html.DropDownList("provincias", Model.Provincias, "", new { @class = "form-control", style = "height:25px;" })
                    </div>
                </div>

                <div class="row">
                    <div class="col-xs-6 col-md-5">
                        <label>Req. Informe</label>
                    </div>
                    <div class="col-xs-6 col-md-6">
                        @Html.DropDownList("reqInformes", Model.reqInformes, "", new { @class = "form-control", style = "height:25px;" })
                    </div>
                </div>

                <div class="row">
                    <div class="col-xs-6 col-md-5">
                        <label>Organismo</label>
                    </div>
                    <div class="col-xs-6 col-md-6">
                        @Html.DropDownList("organismos", Model.Organismos, "", new { @class = "form-control", style = "height:25px;" })
                    </div>
                </div>
                <div class="row">
                    <div class="col-xs-6 col-md-5">
                        <label>Solucionado</label>
                    </div>
                    <div class="col-xs-6 col-md-6">
                        @Html.DropDownList("solucionados", Model.Solucionados, "", new { @class = "form-control", style = "height:25px;" })
                    </div>
                </div>

                <div class="row">
                    <div class="col-xs-6 col-md-5">
                        <label>Responsable</label>
                    </div>
                    <div class="col-xs-6 col-md-6">
                        @Html.DropDownList("responsable", Model.Responsables, "", new { @class = "form-control", style = "margin-right:50px;height:25px;" })

                    </div>
                </div>

                <div class="row">
                    <div class="col-xs-6 col-md-5">
                        <label>Dni Denunciante</label>
                    </div>
                    <div class="col-xs-6 col-md-6">
                        <input type="text" value="@Model.dniDenunciante" id="dniDenunciante" class="form-control" style="height:25px;" onkeypress="onEnterAgenda(event)"/>
                    </div>
                </div>

                <div class="row">
                    <div class="col-xs-6 col-md-5">
                        <label>Id Denuncia</label>
                    </div>
                    <div class="col-xs-6 col-md-6">
                        <input type="text" id="idDenuncia" class="form-control" style="height:25px;" onkeypress="onEnterAgenda(event)"/>
                    </div>
                </div>
                <div class="row">
                    <div class="col-xs-6 col-md-5">
                        <label>Contestado</label>
                    </div>
                    <div class="col-xs-6 col-md-6" style="margin-bottom:5px;margin-left:-80px;">
                        <input type="checkbox" checked="@Model.contestado" id="checkboxContestado" />
                    </div>
                </div>

            </div>
        </div>
    </form>
    </div>
<br />

<!-- Modal Delete-->
<div class="modal fade" id="deleteModalEvento" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal">×</button>
            </div>
            <div id="deletePopupContent" class="modal-body center-block">
                <h4 class="text-center">Está seguro que desea eliminar al Evento : </h4>
                <h4 class="text-center" id="idDeleteEventHidden"></h4>

            </div>
            <div id="deleteFooterContent" class="modal-footer">
                <button type="button" class="btn btn-primary" id="btnDelete" onclick="eliminarEvento()" data-dismiss="modal">Aceptar</button>
                <button type="button" class="btn btn-default" data-dismiss="modal">Cancelar</button>
            </div>
        </div>
    </div>
</div>

<!-- Modal -->
<div class="modal fade" id="editEventModal" role="dialog" data-collapsed="true">
    <div class="modal-dialog">

        <!-- Modal content-->
        <div class="modal-content">
            <div class="modal-header"
                 style="background-color:#337ab7; color:white;">
                <button type="button" class="close" data-dismiss="modal">&times;</button>

                

                <h4 class="modal-title" id="myModalLabel" style="margin-left:50px;">Editar Evento</h4>

            </div>

            <div class="modal-body">

                <div id="divEventoAEditar"></div>

            </div>

            <div class="modal-footer">

                <button type="button" class="btn btn-primary" onclick="guardarEventoEditado()" id="btnGuardarEventoEditado">Guardar</button>
                <button type="button" class="btn btn-default" data-dismiss="modal">Cancelar</button>

            </div>

        </div>

    </div>

</div>


<div class="text-center" style="display:none;" id="divLoadingAgendaMM">
    <div class="loader-container">
        <div class="loader"></div>
    </div>

    @*<img src="@Url.Content("~/Images/4.gif")" />*@
</div>
<div id="divListAgenda" style="margin-left:-80px;margin-right:-100px;overflow:auto;display:none;max-height:400px;margin-top:-5px;">

    <table cellpadding="0" cellspacing="0">
        <tr>
            @for (int i = 1; i <= Model.PageCount; i++)
            {
                <td>
                    @if (i != Model.CurrentPageIndex)
                    {
                        <a href="javascript:PagerClick(@i);">@i</a>
                    }
                    else
                    {
                        <span>@i</span>
                    }
                </td>
            }
        </tr>
    </table>
    <input type="hidden" id="hfCurrentPageIndex" name="currentPageIndex" />

</div>

@*</div>*@
@section scripts{
    <script>
        $(window).on('load', GetListAgendaToday());

        $('#checkboxSoloFechas').on("change", habilitarFiltros());

        function habilitarFiltros(elem) {
            if (!$('#checkboxSoloFechas').is("checked")) {
                $('#tipoEventos').removeAttr("disabled");
                $('#estudios').removeAttr("disabled");
                $('#provincias').removeAttr("disabled");
                $('#reqInformes').removeAttr("disabled");
                $('#organismos').removeAttr("disabled");
                $('#solucionados').removeAttr("disabled");
                $('#dniDenunciante').removeAttr("disabled");
                $('#checkboxContestado').removeAttr("disabled");
            }
            else
                if ($('#checkboxSoloFechas').is("checked"))
            {
                $('#tipoEventos').prop("disabled",true);
                $('#estudios').prop("disabled",true);
                $('#provincias').prop("disabled", true);
                $('#reqInformes').prop("disabled", true);
                $('#organismos').prop("disabled", true);
                $('#solucionados').prop("disabled", true);
                $('#dniDenunciante').prop("disabled", true);
                $('#checkboxContestado').attr("disabled", "disabled");
            }
        }

        function GetListAgendaToday() {
            $('#divListAgenda').css('display', 'block');
            $.ajax({
                url: '@Url.Action("GetListAgendaToday","Agenda")',
                        type: "Get",
                        data: {
                            fechaDesde: $('#fechaDesde').val() + ' ' + '00:00:00',
                            fechaHasta: $('#fechaHasta').val() + ' ' + '23:59:59'
                        },
                        success(response) {
                            $('#divListAgenda').html(response);
                        },
                        error(response) {
                            toastr.error(response.responseText);
                        }
            });

        }

        function BuscarListAgenda() {
            $('#divListAgenda').css('display', 'block');

            var fechaDesde = $('#fechaDesde');
            var fechaHasta = $('#fechaHasta');
            var fechaInicial;
            var fechaFinal;
            if ($('#filtroPorFechaVencimiento').prop('checked')) {
                fechaInicial = (fechaDesde.val().trim().length > 0) ? fechaDesde.val() + ' ' + '00:00:00' : '';
                fechaFinal = (fechaHasta.val().trim().length > 0) ? fechaHasta.val() + ' ' + '00:00:00' : '';


            } else {
                fechaInicial = fechaDesde.val();
                fechaFinal = fechaHasta.val();

            }

            //var fechaInicial;
            //var fechaFinal;
            //if ($('#filtroPorFechaVencimiento').prop('checked')) {
            //    fechaInicial = $('#fechaDesde').val() + ' ' + '00:00:00';
            //    fechaFinal = $('#fechaHasta').val() + ' ' + '23:59:59';
            //} else {
            //    fechaInicial = $('#fechaDesde').val();
            //    fechaFinal = $('#fechaHasta').val();
            //}
                    
            $.ajax({
                url: '@Url.Action("BuscarListAgenda","Agenda")',
                        type: "Post",
                        data: {
                            fechaDesde: fechaInicial,/*$('#fechaDesde').val() + ' ' + '00:00:00',*/
                            fechaHasta: fechaFinal,/*$('#fechaHasta').val() + ' ' + '23:59:59',*/
                            soloFechas: $('#checkboxSoloFechas').prop('checked'),
                            tipoEventoSeleccionado: $('#tipoEventos option:selected').val(),
                            estudioSeleccionado: $('#estudios option:selected').val(),
                            provinciaSeleccionada: $('#provincias option:selected').val(),
                            reqInformeSeleccionado: $('#reqInformes option:selected').val(),
                            organismoSeleccionado: $('#organismos option:selected').val(),
                            solucionadoSeleccionado: $('#solucionados option:selected').val(),
                            responsableSeleccionado: $('#responsable option:selected').val(),
                            dniDenunciante: $('#dniDenunciante').val(),
                            idDenuncia: $('#idDenuncia').val(),
                            //contestado: contestadoValue,
                            contestado: $('#checkboxContestado').prop('checked'),
                            currentPageIndex: $('#hfCurrentPageIndex').val(),
                            filtrarPorFechaVencimiento: $('#filtroPorFechaVencimiento').prop('checked'),
                            filtrarPorFechaDenuncia: $('#filtroPorFechaDenuncia').prop('checked'),
                            filtrarPorFechaNotificacion: $('#filtroPorFechaNotificacion').prop('checked'),
                            filtrarPorFechaNotificacionGcia: $('#filtroPorFechaNotificacionGcia').prop('checked')
                           
                        },
                success(response) {
                    //$('#divListAgenda').empty();
                    $('#divListAgenda').html(response);
                    $('#divListAgenda').css('border','inherit');
                        },
                        error(response) {
                            toastr.error(response.responseText);
                        }
            });

        }

        function ExportListAgenda() {
            var fechaInicial;
            var fechaFinal;
            if ($('#filtroPorFechaVencimiento').prop('checked')) {
                fechaInicial = $('#fechaDesde').val() + ' ' + '00:00:00';
                fechaFinal = $('#fechaHasta').val() + ' ' + '23:59:59';
            } else {
                fechaInicial = $('#fechaDesde').val();
                fechaFinal = $('#fechaHasta').val();
            }
            $.ajax({
                url: '@Url.Action("ExportarListAgenda","Agenda")',
                        type: "POST",
                data: {
                            fechaDesde: fechaInicial,
                            fechaHasta: fechaFinal,
                            tipoEventoSeleccionado: $('#tipoEventos option:selected').val(),
                            estudioSeleccionado: $('#estudios option:selected').val(),
                            provinciaSeleccionada: $('#provincias option:selected').val(),
                            reqInformeSeleccionado: $('#reqInformes option:selected').val(),
                            organismoSeleccionado: $('#organismos option:selected').val(),
                            solucionadoSeleccionado: $('#solucionados option:selected').val(),
                            responsableSeleccionado: $('#responsable option:selected').val(),
                            dniDenunciante: $('#dniDenunciante').val(),
                            idDenuncia: $('#idDenuncia').val(),
                            contestado: $('#checkboxContestado').prop('checked'),
                            //currentPageIndex: $('#hfCurrentPageIndex').val(),
                            filtrarPorFechaVencimiento: $('#filtroPorFechaVencimiento').prop('checked'),//filtroPorFechaNotificacion
                            filtrarPorFechaNotificacion: $('#filtroPorFechaNotificacion').prop('checked'),
                            filtrarPorFechaNotificacionGcia: $('#filtroPorFechaNotificacionGcia').prop('checked')
                            //filtrarPorFechaDenuncia: $('#filtroPorFechaDenuncia').prop('checked')
                        },
                //success(response) {
                //    window.open('data:application/vnd.ms-excel,' + encodeURIComponent(response));
                //}
                success: function (data) {
                    if (data != null && (data.errorMessage == null || data.errorMessage === "")) {

                        if (data.fileName != "" && data.fileName != "isEmpty") {

                            window.location.href = "Agenda/DownloadSpreadsheet/?file=" + data.fileName;
                        } else
                            if (data.fileName == "isEmpty") {
                                toastr.options.positionClass = "toast-bottom-left";
                                toastr.warning("No existen datos a Exportar");
                        }
                    } else {
                        toastr.error("Error : ", data.errorMessage);
                    }
                }
                ,
                error(response) {
                    toastr.error(response.responseText);
                }
            });

        }

        function excelReport() {
            var tab_text = "<table border='2px'><tr bgcolor='#87AFC6'>";
            var textRange; var j = 0;
            tab = document.getElementById('listaAgenda'); // id of table

            for (j = 0; j < tab.rows.length; j++) {
                tab_text = tab_text + tab.rows[j].innerHTML + "</tr>";
                //tab_text=tab_text+"</tr>";
            }

            tab_text = tab_text + "</table>";


            var ua = window.navigator.userAgent;
            var msie = ua.indexOf("MSIE ");

            if (msie > 0 || !!navigator.userAgent.match(/Trident.*rv\:11\./))      // If Internet Explorer
            {
                txtArea1.document.open("txt/html", "replace");
                txtArea1.document.write(tab_text);
                txtArea1.document.close();
                txtArea1.focus();
                sa = txtArea1.document.execCommand("SaveAs", true, "Global View Task.xls");
            }
            else //other browser not tested on IE 11
                sa = window.open('data:application/vnd.ms-excel,' + encodeURIComponent(tab_text));
            return (sa);
        }
        function clonarFecha(elem) {
            $('#fechaHasta').val($(elem).val());
        }
                //Los métodos de los Eventos están duplicados también en la vista DenunciaEdición
                function getEventobyId(EventID) {
                $.ajax({
                    url: '@Url.Action("EditarEvento", "Home")' /*+ EventID */,
                    type: "POST",
                    data: { id:EventID},

                    success: function (result) {
                        $('#divEventoAEditar').html(result);
                    },
                    error: function (result) {
                        toastr.error(result.responseText)
                    }

                });

                return false;

                }

            var eventoARemover;
            function ConfirmarEliminarEvento(id, element) {
                $('#idDeleteEventHidden').html(id);
                eventoARemover = $(element).parent().parent();

            }

            function eliminarEvento() {

                var idEvent = parseInt($('#idDeleteEventHidden').text());
                                try {
                                    $.ajax({
                                        url: '@Url.Action("EliminarEvento","Denuncias")',
                                        type: "Post",
                                        data: {
                                            id: idEvent

                                        },
                                        success: function (result) {

                                            if (result == "Registro eliminado con éxito") {
                                                eventoARemover.remove();
                                                eventoARemover = undefined;
                                            }
                                            toastr.info(result);
                                        },
                                        error: function (result) {
                                            toastr.error(result.responseText);
                                        }
                                    });
                                } catch (error) {
                                    toastr.error(error)
                                }
            }

                function elEventoEditadoEsVálido() {
                    $('#btnGuardarEventoEditado').removeAttr("data-dismiss");
                    var control = true;
                    var creacion = $('#fechaCreacionEE').val();
                    var fechaCreacion = new Date(creacion);
                    var today = new Date();
                    var vencimiento = $('#fechaVencimientoEE').val();
                    var fechaVencimiento = new Date(vencimiento);
                    if ($('#fechaVencimientoEE').val().length == 0) {

                        toastr.warning('Ingrese la Fecha De Vencimiento');
                        control = false;
                    }
                    if ($('#horaVencimientoEE').val().length == 0) {
                        //console.log($('#horaVencimientoEE').val().length == 0);
                        toastr.warning('Ingrese la Hora De Vencimiento');
                        control = false;
                    }
                    //comentado el 17/10. Estas 2 condiciones están vigentes en la versión del sprint 2
                    //
                    //if (fechaVencimiento < fechaCreacion) {
                    //    toastr.warning("La fecha de vencimiento debe ser posterior a la fecha de Creación");
                    //    control = false;
                    //}
                    //if ((today > fechaVencimiento)) {
                    //    toastr.warning("La fecha de vencimiento no puede ser anterior a la fecha actual");
                    //    control = false;

                    //}

                    if (control) {
                        console.log(control);
                        $('#btnGuardarEventoEditado').attr("data-dismiss", "modal");
                    }

                    return control;
                }


                function guardarEventoEditado() {
                console.log($('input:checkbox[name=estaContestadoEE]:checked').val());
                if (elEventoEditadoEsVálido()) {
                $.ajax({
                    url: '@Url.Action("guardarEventoEditado","Denuncias")',
                    type: "Post",
                    data: {
                        EventoId: $('#idEventoAEditar').val(),
                        DenunciaId: $('#nroDenuncia').text(),
                        Fecha: $('#fechaVencimientoEE').val() + ' ' + $('#horaVencimientoEE').val(),
                        tipoEvento: $('#comboTipoEventoEE option:selected').val(),
                        /*CONTESTADO: $('input:checkbox[name=estaContestadoEE]:checked').val(),*//*('#contestadoEE').val()*/
                        CONTESTADO: $('#ContestadoEE').prop('checked'),
                        SOLUCIONADO: $('#comboSolucionadoEE option:selected').val(),
                        REQUERIMIENTOINFORME: $('#comboReqInformeEE option:selected').val(),
                        Observacion: $('#observacionEE').val(),
                        ResIntId: $('#responsableInternoEventoEdicion option:selected').val()
                    },
                    success(response) {
                        //$('#divListAgenda').html(response);
                        toastr.success('Evento guardado correctamente');
                        BuscarListAgenda();
                        $('.modal-backdrop').hide();
                        $('#btnGuardarEventoEditado').removeAttr("data-dismiss");
                        $('body').css('overflow-y', 'visible');
                    },
                    error(response) {
                        //toastr.options.positionClass = 'top-full-widht';
                        toastr.error(response.responseText + ' ' + response.statusText)
                    }
                    });
                }
            }


        function limpiarFiltros() {
            $('#tipoEventos')[0].selectedIndex = 0;
            $('#estudios')[0].selectedIndex = 0;
            $('#provincias')[0].selectedIndex = 0;
            $('#reqInformes')[0].selectedIndex = 0;
            $('#organismos')[0].selectedIndex = 0;
            $('#solucionados')[0].selectedIndex = 0;
            $('#dniDenunciante').val('');
            $('#idDenuncia').val('');
            $('#responsable')[0].selectedIndex = 0;
            $('#checkboxContestado').prop('checked', false);
            $('#divListAgenda').empty();
        }


        function descargarExcel() {
            //Creamos un Elemento Temporal en forma de enlace
            var tmpElemento = document.createElement('a');
            // obtenemos la información desde el div que lo contiene en el html
            // Obtenemos la información de la tabla
            var data_type = 'data:application/vnd.ms-excel';
            var tabla_div = document.getElementById('tblReporte');
            var tabla_html = tabla_div.outerHTML.replace(/ /g, '%20');
            tmpElemento.href = data_type + ', ' + tabla_html;
            //Asignamos el nombre a nuestro EXCEL
            tmpElemento.download = 'Nombre_De_Mi_Excel.xlsx';
            // Simulamos el click al elemento creado para descargarlo
            tmpElemento.click();
        }

                function PagerClick(index) {
                    document.getElementById("hfCurrentPageIndex").value = index;

                    BuscarListAgenda();
                    //document.forms[0].submit();

                    //$.ajax(
                    //    {
                    //        type: "POST",
                    //        url: "/Home/Index",
                    //        data: {
                    //            currentPageIndex: index
                    //        }

                    //    }).done(function (result) {
                    //        if (result != null) {
                    //            $("#divListAgenda").html(result);

                    //        }
                    //    });
                }

                function BuscarPaginaUno() {
                    $.ajax(
                        {
                            type: "POST",
                            url: "/Home/Buscar",

                        }).done(function (result) {
                            if (result != null) {
                                $("#divListAgenda").html(result);

                            }
                        });
                }

        $('#provincias').change(function () {

             $.ajax({
                    url: '@Url.Action("GetOrganismosPorProvincia", "Agenda")',
                    type: "Post",
                    data: {
                        idProvincia: $('#provincias option:selected').val()
                    },
                    success: function (response) {
                        $('#organismos').empty();
                        $('#organismos').append('<option value=0/>');
                        $(response).each(function () {
                            $('#organismos').append(
                                $('<option/>', { value: this.Id }).html(this.Nombre)
                            );
                        });

                    },
                    error: function (response) {
                        toastr.error(response);
                    }
                });
        });

        function Volver() {
            history.back();
        }
        //function agregarHoraInicio(elem) {
        //    $(elem).val($(elem).val + ' ' +'00:00:00')
        //}

        //function agregarHoraFin(elem) {
        //    $(elem).val($(elem).val + ' ' + '23:59:59')
        //}
    </script>

}

